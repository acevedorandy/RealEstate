@model RealEstate.Persistance.Models.EnumerablesModel.PropiedadDetallesModel

@{
    ViewData["Title"] = $"Vendo {Model.PropiedadesModel.Titulo}";
}

<!-- CSS de Bootstrap y Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

<!-- JS de Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    .property-header {
        background-color: #f8f9fa;
        padding: 1.5rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
    }
    .price-badge {
        font-size: 1.5rem;
        padding: 0.5rem 1rem;
    }
    .feature-icon {
        font-size: 1.5rem;
        color: #0d6efd;
    }
    .thumbnail {
        transition: transform 0.2s;
    }
    .thumbnail:hover {
        transform: scale(1.05);
        cursor: pointer;
    }
    .agent-card {
        border-radius: 0.5rem;
        overflow: hidden;
        max-height: 180px;
    }
    .offer-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 1000;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .agent-avatar {
        width: 60px;
        height: 60px;
        object-fit: cover;
    }
    .title-agent-container {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 20px;
    }
    .title-container {
        flex: 1;
    }
    .agent-container {
        width: 300px;
    }
    media (max-width: 992px) {
        .title-agent-container {
            flex-direction: column;
        }
        .agent-container {
            width: 100%;
        }
    }
</style>

<div class="container py-4">
    <!-- Contenedor de título y agente -->
    <div class="title-agent-container mb-4">
        <!-- Título y precio -->
        <div class="title-container property-header">
            <div>
                <h3 class="mb-1">@Model.PropiedadesModel.Titulo</h3>
                <p class="mb-0"><i class="bi bi-geo-alt-fill"></i> @Model.PropiedadesModel.Sector, @Model.PropiedadesModel.Ciudad</p>
            </div>
            <div class="price-badge d-inline-block">
                RD$@Model.PropiedadesModel.Precio.ToString("N0")
            </div>
        </div>
        
        <!-- Tarjeta del agente (versión compacta) -->
        <div class="agent-container">
            <div class="card shadow-sm agent-card h-100">
                <div class="card-body d-flex align-items-center">
                    <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="rounded-circle me-3 shadow-sm agent-avatar" />
                    <div>
                        <h6 class="mb-1">@Model.UsuariosModel.Nombre @Model.UsuariosModel.Apellido</h6>
                        <p class="text-muted small mb-2">Agente Inmobiliario</p>
                        <!--
                        <div class="d-flex gap-2">
                            <a href="tel:@Model.UsuariosModel.Telefono" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-telephone"></i>
                            </a>
                            <a href="https://wa.me/Model.UsuariosModel.Celular" target="_blank" class="btn btn-sm btn-success">
                                <i class="bi bi-whatsapp"></i>
                            </a>
                            <a href="mailto:@Model.UsuariosModel.Email" class="btn btn-sm btn-outline-dark">
                                <i class="bi bi-envelope-fill"></i>
                            </a>
                        </div>
                        -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Galería + Info -->
        <div class="col-lg-12">
            <!-- Galería -->
            @if (Model.PropiedadFotosModel != null && Model.PropiedadFotosModel.Any())
            {
                <div id="mainCarousel" class="carousel slide mb-3 shadow-sm" data-bs-ride="carousel">
                    <div class="carousel-inner rounded">
                        @for (int i = 0; i < Model.PropiedadFotosModel.Count; i++)
                        {
                            <div class="carousel-item @(i == 0 ? "active" : "")">
                                <img src="@Url.Content(Model.PropiedadFotosModel[i].Imagen)" class="d-block w-100" style="max-height: 500px; object-fit: cover;" />
                            </div>
                        }
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                    </button>
                </div>

                <!-- Miniaturas -->
                <div class="d-flex flex-wrap gap-2 mb-4">
                    @for (int i = 0; i < Model.PropiedadFotosModel.Count; i++)
                    {
                        <img src="@Url.Content(Model.PropiedadFotosModel[i].Imagen)"
                             class="thumbnail rounded"
                             style="height: 80px; width: auto; object-fit: cover;"
                             onclick="$('#mainCarousel').carousel(@i)" />
                    }
                </div>
            }

            <!-- Descripción -->
            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-card-text"></i> Descripción</h5>
                    <p class="card-text">@Model.PropiedadesModel.Descripcion</p>
                </div>
            </div>

            <!-- Resumen -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-4"><i class="bi bi-info-circle"></i> Detalles de la propiedad</h5>
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-house-door-fill feature-icon me-2"></i>Tipo de propiedad</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.TipoPropiedad</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-geo-alt-fill feature-icon me-2"></i>Ubicación</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.Ciudad, @Model.PropiedadesModel.Sector</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-aspect-ratio-fill feature-icon me-2"></i>Tamaño del terreno</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.TamañoTerreno m²</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-calendar-event feature-icon me-2"></i>Año de construcción</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.AñoConstruccion.ToString("yyyy")</span>
                                </li>
                            </ul>
                        </div>

                        <div class="col-md-6">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span>
                                        <i class="fas fa-bed"></i>
                                        Habitaciones
                                    </span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.Habitaciones</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-badge-wc-fill feature-icon me-2"></i>Baños</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.Baños</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-car-front-fill feature-icon me-2"></i>Parqueos</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.Parqueos</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <span><i class="bi bi-building feature-icon me-2"></i>Piso/Nivel</span>
                                    <span class="badge bg-light text-dark">@Model.PropiedadesModel.Piso de @Model.PropiedadesModel.TotalNivel</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Características adicionales (comentado) -->
            @*
            @if (Model.PropiedadesModel.Caracteristicas != null && Model.PropiedadesModel.Caracteristicas.Any())
            {
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4"><i class="bi bi-star-fill"></i> Características</h5>
                        <div class="d-flex flex-wrap gap-2">
                            @foreach (var feature in Model.PropiedadesModel.Caracteristicas)
                            {
                                <span class="badge bg-primary bg-opacity-10 text-primary p-2">
                                    <i class="bi bi-check-circle-fill me-1"></i> @feature
                                </span>
                            }
                        </div>
                    </div>
                </div>
            }
            *@
        </div>
    </div>
</div>

<!-- Botón flotante para ver ofertas -->
<a href="@Url.Action("PropertyOffers", "Propiedades", new { id = Model.PropiedadesModel.PropiedadID })"
   class="btn btn-warning offer-btn rounded-pill px-4 py-2 d-flex align-items-center">
    <i class="bi bi-cash-stack me-2"></i> Ver Ofertas
</a>